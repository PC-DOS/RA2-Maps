SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_category = {

    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_internal_affairs_separator = {
        allowed = {
            # Always allowed
        }
        visible = {
            # Always visible
        }
        available = {
            always = no
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_internal_affairs_finish_democratization = {
        allowed = {
            # Always allowed
        }
        visible = {
            # Always visible
        }
        available = {
            # Always available
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            CHI = {
                set_politics = {
                    ruling_party = democratic
                    elections_allowed = yes
                    last_election = "1935.10.10"
                    election_frequency = 48
                }
                set_popularities = {
                    democratic = 75
                    neutrality = 25
                    communism = 0
                    fascism = 0
                }
            }
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_internal_affairs_reunification = {
        allowed = {
            # Always allowed
        }
        visible = {
            # Always visible
        }
        available = {
            # Always available
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            CHI = {
                # Warlords and separations
                annex_country = {
                    target = GXC
                    transfer_troops = yes
                }
                annex_country = {
                    target = SHX
                    transfer_troops = yes
                }
                annex_country = {
                    target = SIK
                    transfer_troops = yes
                }
                annex_country = {
                    target = XSM
                    transfer_troops = yes
                }
                annex_country = {
                    target = YUN
                    transfer_troops = yes
                }
                annex_country = {
                    target = PRC
                    transfer_troops = yes
                }
                annex_country = {
                    target = MAN
                    transfer_troops = yes
                }
                annex_country = {
                    target = MEN
                    transfer_troops = yes
                }
                annex_country = {
                    target = MON
                    transfer_troops = yes
                }
                annex_country = {
                    target = TAN
                    transfer_troops = yes
                }
                annex_country = {
                    target = TIB
                    transfer_troops = yes
                }
                
                # Occupied stats
                every_state = {
                    limit = {
                        OR = {
                            is_claimed_by = CHI
                            is_core_of = CHI
                        }
                        NOT = {
                            is_controlled_by = CHI
                        }
                    }
                    transfer_state_to = CHI
                }
                
                # Southern Tibet
                transfer_state = 434
                
                # Outer Northeast China
                transfer_state = 657
                transfer_state = 560
                transfer_state = 409
                transfer_state = 408
                transfer_state = 655
                transfer_state = 537
                
                # Add core
                every_controlled_state = {
                    cancel_resistance = yes
                    add_core_of = CHI
                }
                for_each_loop = {
                    array = global.countries
                    value = temp_current_country
                    
                    if = {
                        limit = {
                            NOT = {
                                check_variable = { temp_current_country = CHI }
                            }
                        }
                        CHI = {
                            every_controlled_state = {
                                remove_claim_by = temp_current_country
                                remove_core_of = temp_current_country
                            }
                        }
                    }
                }
            }
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_internal_affairs_liberate_neighboring_countries = {
        allowed = {
            # Always allowed
        }
        visible = {
            # Always visible
        }
        available = {
            # Always available
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            every_state = {
                limit = {
                    OR = {
                        is_core_of = KOR
                        is_claimed_by = KOR
                    }
                }
                transfer_state_to = KOR
                add_core_of = KOR
            }
            CHI = {
                puppet = KOR
            }
            
            every_state = {
                limit = {
                    OR = {
                        is_core_of = FSM
                        is_claimed_by = FSM
                    }
                }
                transfer_state_to = FSM
                add_core_of = FSM
            }
            CHI = {
                puppet = FSM
            }
            
            every_state = {
                limit = {
                    OR = {
                        is_core_of = GUM
                        is_claimed_by = GUM
                    }
                }
                transfer_state_to = GUM
                add_core_of = GUM
            }
            CHI = {
                puppet = GUM
            }
            
            every_state = {
                limit = {
                    OR = {
                        is_core_of = VIN
                        is_claimed_by = VIN
                    }
                }
                transfer_state_to = VIN
                add_core_of = VIN
            }
            CHI = {
                puppet = VIN
            }
            
            every_state = {
                limit = {
                    OR = {
                        is_core_of = LAO
                        is_claimed_by = LAO
                    }
                }
                transfer_state_to = LAO
                add_core_of = LAO
            }
            CHI = {
                puppet = LAO
            }
            
            every_state = {
                limit = {
                    OR = {
                        is_core_of = BRM
                        is_claimed_by = BRM
                    }
                }
                transfer_state_to = BRM
                add_core_of = BRM
            }
            CHI = {
                puppet = BRM
            }
            
            every_state = {
                limit = {
                    OR = {
                        is_core_of = BAN
                        is_claimed_by = BAN
                    }
                }
                transfer_state_to = BAN
                add_core_of = BAN
                remove_claim_by = PAK
                remove_core_of = PAK
                remove_claim_by = RAJ
                remove_core_of = RAJ
            }
            CHI = {
                puppet = BAN
            }
            
            every_state = {
                limit = {
                    OR = {
                        is_core_of = PAK
                        is_claimed_by = PAK
                    }
                }
                transfer_state_to = PAK
                add_core_of = PAK
                remove_claim_by = RAJ
                remove_core_of = RAJ
            }
            CHI = {
                puppet = PAK
            }
            
            every_state = {
                limit = {
                    OR = {
                        is_core_of = SRL
                        is_claimed_by = SRL
                    }
                }
                transfer_state_to = SRL
                add_core_of = SRL
            }
            CHI = {
                puppet = SRL
            }
            
            every_state = {
                limit = {
                    OR = {
                        is_core_of = MLD
                        is_claimed_by = MLD
                    }
                }
                transfer_state_to = MLD
                add_core_of = MLD
            }
            CHI = {
                puppet = MLD
            }
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_inflation_separator = {
        allowed = {
            # Always allowed
        }
        visible = {
            # Always visible
        }
        available = {
            always = no
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_inflation_clear = {
        allowed = {
            # Always allowed
        }
        visible = {
            # Always visible
        }
        available = {
            # Always available
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            CHI_hyper_inflation_clear_all = yes
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_inflation_level_up = {
        allowed = {
            # Always allowed
        }
        visible = {
            # Always visible
        }
        available = {
            # Always available
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            CHI_hyper_inflation_level_up = yes
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_inflation_level_down = {
        allowed = {
            # Always allowed
        }
        visible = {
            # Always visible
        }
        available = {
            # Always available
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            CHI_hyper_inflation_level_down = yes
        }
    }

    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_JAP_fate_separator = {
        allowed = {
            # Always allowed
        }
        visible = {
            JAP = {
                is_subject_of = CHI
            }
        }
        available = {
            always = no
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_JAP_fate_rename_occupied_zone = {
        allowed = {
            # Always allowed
        }
        visible = {
            JAP = {
                is_subject_of = CHI
            }
        }
        available = {
            JAP = {
                is_subject_of = CHI
            }
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            CHI = {
                end_puppet = JAP
                puppet = JAP
            }
            JAP = {
                set_cosmetic_tag = SCP_EQ_Tools_JAP_CHI_puppet_occupied_zone
                add_stability = 5.0
                remove_ideas = {
                    state_shintoism
                    JAP_zaibatsus
                    JAP_duplicate_research_efforts
                    JAP_militarism
                }
                load_focus_tree = SCP_EQ_Tools_hoi4_base_game_ext_national_focuses_empty_focus_tree
                set_politics = {
                    ruling_party = neutrality
                }
                set_popularities = {
                    democratic = 25
                    neutrality = 75
                    communism = 0
                    fascism = 0
                }
                set_party_name = {
                    ideology = democratic
                    long_name = SCP_EQ_Tools_JAP_CHI_puppet_democratic_party
                    name = SCP_EQ_Tools_JAP_CHI_puppet_democratic_party
                }
                set_party_name = {
                    ideology = neutrality
                    long_name = SCP_EQ_Tools_JAP_CHI_puppet_neutrality_party
                    name = SCP_EQ_Tools_JAP_CHI_puppet_neutrality_party
                }
                set_party_name = {
                    ideology = fascism
                    long_name = SCP_EQ_Tools_JAP_CHI_puppet_fascism_party
                    name = SCP_EQ_Tools_JAP_CHI_puppet_fascism_party
                }
            }
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_JAP_fate_rename_SAR = {
        allowed = {
            # Always allowed
        }
        visible = {
            JAP = {
                is_subject_of = CHI
            }
        }
        available = {
            JAP = {
                is_subject_of = CHI
            }
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            CHI = {
                end_puppet = JAP
                puppet = JAP
            }
            JAP = {
                set_cosmetic_tag = SCP_EQ_Tools_JAP_CHI_puppet_SAR
                add_stability = 5.0
                remove_ideas = {
                    state_shintoism
                    JAP_zaibatsus
                    JAP_duplicate_research_efforts
                    JAP_militarism
                }
                load_focus_tree = SCP_EQ_Tools_hoi4_base_game_ext_national_focuses_empty_focus_tree
                set_politics = {
                    ruling_party = neutrality
                }
                set_popularities = {
                    democratic = 45
                    neutrality = 55
                    communism = 0
                    fascism = 0
                }
                set_party_name = {
                    ideology = democratic
                    long_name = SCP_EQ_Tools_JAP_CHI_puppet_democratic_party
                    name = SCP_EQ_Tools_JAP_CHI_puppet_democratic_party
                }
                set_party_name = {
                    ideology = neutrality
                    long_name = SCP_EQ_Tools_JAP_CHI_puppet_neutrality_party
                    name = SCP_EQ_Tools_JAP_CHI_puppet_neutrality_party
                }
                set_party_name = {
                    ideology = fascism
                    long_name = SCP_EQ_Tools_JAP_CHI_puppet_fascism_party
                    name = SCP_EQ_Tools_JAP_CHI_puppet_fascism_party
                }
            }
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_JAP_fate_hirohito_execution = {
        allowed = {
            # Always allowed
        }
        visible = {
            JAP = {
                is_subject_of = CHI
            }
        }
        available = {
            JAP = {
                is_subject_of = CHI
            }
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            JAP = {
                kill_ideology_leader = fascism
                retire_character = JAP_emperor_hirohito
            }
            CHI = {
                country_event = SCP_EQ_Tools_hoi4_base_game_ext_events_CHI_execution_of_hirohito.1
                country_event = {
                    id = SCP_EQ_Tools_hoi4_base_game_ext_events_CHI_execution_of_hirohito.2
                    days = 1
                }
                country_event = {
                    id = SCP_EQ_Tools_hoi4_base_game_ext_events_CHI_execution_of_hirohito.3
                    days = 2
                }
                country_event = {
                    id = SCP_EQ_Tools_hoi4_base_game_ext_events_CHI_execution_of_hirohito.4
                    days = 3
                }
                country_event = {
                    id = SCP_EQ_Tools_hoi4_base_game_ext_events_CHI_execution_of_hirohito.5
                    days = 4
                }
            }
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_JAP_fate_greate_purge = {
        allowed = {
            # Always allowed
        }
        visible = {
            JAP = {
                is_subject_of = CHI
            }
        }
        available = {
            JAP = {
                is_subject_of = CHI
            }
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            JAP = {
                every_character = {
                    retire = yes
                }
            }
            CHI = {
                country_event = SCP_EQ_Tools_hoi4_base_game_ext_events_CHI_tokyo_is_nanking.1
            }
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_JAP_fate_pause_military_supervision = {
        allowed = {
            # Always allowed
        }
        visible = {
            JAP = {
                is_subject_of = CHI
            }
        }
        available = {
            JAP = {
                is_subject_of = CHI
            }
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            JAP = {
                delete_unit = {
                    disband = no
                }
                add_stability = 5.0
                every_controlled_state = {
                    # Tokyo is Nanking, too
                    add_manpower = -1245000
                    JAP = {
                        add_manpower = -1245000
                    }
                    if = {
                        limit = {
                            state_population_k < 0.001
                            state_population < 1
                        }
                        add_manpower = 1
                    }
                    # Damage building
                    add_extra_state_shared_building_slots = -5
                    damage_building = {
                        type = infrastructure
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    damage_building = {
                        type = arms_factory
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    damage_building = {
                        type = industrial_complex
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    damage_building = {
                        type = air_base
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    damage_building = {
                        type = dockyard
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    damage_building = {
                        type = anti_air_building
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    damage_building = {
                        type = synthetic_refinery
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    damage_building = {
                        type = fuel_silo
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    damage_building = {
                        type = radar_station
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    damage_building = {
                        type = rocket_site
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    damage_building = {
                        type = nuclear_reactor
                        damage = 25
                        repair_speed_modifier = -5.0
                    }
                    # Remove military buildings
                    remove_building = {
                        type = arms_factory
                        level = 25
                    }
                    remove_building = {
                        type = dockyard
                        level = 25
                    }
                    remove_building = {
                        type = air_base
                        level = 25
                    }
                    remove_building = {
                        type = anti_air_building
                        level = 25
                    }
                    remove_building = {
                        type = rocket_site
                        level = 25
                    }
                    remove_building = {
                        type = nuclear_reactor
                        level = 25
                    }
                }
            }
            CHI = {
                country_event = SCP_EQ_Tools_hoi4_base_game_ext_events_CHI_tokyo_is_nanking.2
            }
        }
    }
    SCP_EQ_Tools_hoi4_base_game_ext_decisions_CHI_JAP_fate_overall_nuke_experiment = {
        allowed = {
            # Always allowed
        }
        visible = {
            JAP = {
                is_subject_of = CHI
            }
        }
        available = {
            JAP = {
                is_subject_of = CHI
            }
        }
        icon = GFX_SCP_EQ_Tools_generic_icons_SCP_1_Generic_Small
        fire_only_once = no
        days_re_enable = 0
        ai_will_do = {
            factor = 0
        }
        complete_effect = {
            set_temp_variable = { temp_param_nuke_target_tag = JAP }
            set_temp_variable = { temp_param_nuke_sender_tag = ROOT } 
            set_temp_variable = { temp_param_is_advanced_nuking_enabled = 1 }
            JAP = {
                every_controlled_state = {
                    set_temp_variable = { temp_param_nuke_target_state = THIS }
                    var:temp_param_nuke_target_state = {
                        set_temp_variable = { temp_nuke_target_state = THIS }
                        log = "Nuking state: [?temp_nuke_target_state.GetID] ([?temp_nuke_target_state.GetName])"
                        var:temp_param_nuke_sender_tag = {
                            launch_nuke = {
                                state = temp_nuke_target_state
                                controller = var:temp_param_nuke_target_tag
                                use_nuke = no
                            }
                        }
                        if = {
                            limit = {
                                check_variable = { temp_param_is_advanced_nuking_enabled > 0 }
                            }
                            # Go hell with your Showa bullshit, JAPs!
                            # Delete all units immediately
                            var:temp_param_nuke_target_tag = {
                                delete_unit = {
                                    state = PREV
                                    disband = no
                                }
                            }
                            # Ensure minimal killing
                            add_manpower = -1245000
                            var:temp_param_nuke_target_tag = {
                                add_manpower = -1245000
                            }
                            # Avoid killing all
                            # Leave at least 1 person for the target state
                            # If you killed all pupulation of the target state, the state's population will revert to manpower defined in history/states after save-load sequence
                            if = {
                                limit = {
                                    state_population_k < 0.001
                                    state_population < 1
                                }
                                add_manpower = 1
                            }
                        }
                    }
                }
            }
            for_each_loop = {
                array = global.province_controllers
                value = temp_current_province_controller
                index = temp_current_province_id
                
                if = {
                    limit = {
                        check_variable = { temp_current_province_controller = temp_param_nuke_target_tag }
                    }
                    var:temp_param_nuke_sender_tag = {
                        launch_nuke = {
                            province = var:temp_current_province_id
                            use_nuke = no
                        }
                    }
                }
            }
        }
    }
    
}